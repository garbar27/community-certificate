<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MagicBlock Certificate</title>

  <!-- PDF libs -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <style>
    :root{
      --bg1:#2b0a3d;
      --bg2:#5e2a8f;
      --paper:#f7efcf;
      --purple:#8b5bff;
      --text:#111;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: Georgia, "Times New Roman", serif;
      background: linear-gradient(180deg, var(--bg1), var(--bg2));
      min-height:100vh;
      padding: 22px 26px 50px;
      color:#fff;
    }

    /* top header */
    .top{
      display:flex;
      align-items:center;
      gap:14px;
      flex-wrap:wrap;
    }

    .top h1{
      margin:0 18px 0 0;
      font-size:40px;
      font-weight:700;
      letter-spacing:.2px;
      white-space:nowrap;
    }

    .controls{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    input, select, button{
      height:34px;
      border-radius:6px;
      border:0;
      outline:none;
      padding:0 12px;
      font-size:13px;
    }
    input, select{
      background:#fff;
      color:#111;
    }
    button{
      cursor:pointer;
      background:#fff;
      color:#111;
      font-weight:600;
    }
    button.primary{
      background:#f2f2ff;
    }

    /* certificate wrap */
    .stage{
      margin-top:38px;
      display:flex;
      justify-content:center;
      align-items:center;
    }

    .certificate{
      width: 920px;
      max-width: calc(100vw - 80px);
      background: var(--paper);
      border-radius:22px;
      padding: 26px 34px 26px;
      position:relative;
      color: var(--text);
      box-shadow: 0 18px 45px rgba(0,0,0,.35);
      overflow:hidden;
      min-height: 420px;
    }

    /* logo top-left */
    .brand{
      position:absolute;
      left:26px;
      top:18px;
      display:flex;
      align-items:center;
      gap:10px;
      color: var(--purple);
      font-weight:700;
    }
    .brand img{
      width:26px;
      height:26px;
      object-fit:contain;
      display:block;
    }
    .brand span{
      font-size:16px;
      letter-spacing:.2px;
    }

    /* title */
    .title{
      text-align:center;
      margin-top: 10px;
      font-size: 40px;
      font-weight: 700;
      line-height: 1.05;
      color:#000;
    }
    .title .mb{
      color: var(--purple);
    }

    /* body text (more spacing) */
    .cert-body{
      margin-top: 18px;
      text-align:center;
      line-height: 1.75; /* <- більше відстань між рядками */
    }

    .small{
      font-size: 14px;
      margin: 8px 0 0;
    }

    .name{
      margin: 12px 0 6px;
      font-size: 44px;
      color: var(--purple);
      font-weight: 700;
      letter-spacing: 1px;
    }

    .line{
      font-size: 16px;
      margin: 6px 0;
    }

    .approved{
      font-size: 15px;
      margin-top: 10px;
      font-style: italic;
    }

    /* WIZARDS (bigger + inside certificate) */
    .wizard{
      position:absolute;
      bottom: 14px;
      width: 180px;       /* <- розмір чарівника */
      height: auto;
      z-index: 2;
      pointer-events:none;
      user-select:none;
    }
    .wizard.left{
      left: 26px;
    }
    .wizard.right{
      right: 26px;
    }

    /* make sure certificate content stays above nothing but under wizards if needed */
    .content-layer{
      position:relative;
      z-index:1;
      padding-bottom: 120px; /* щоб текст не залазив на чарівників */
    }

    /* responsive */
    @media (max-width: 820px){
      .title{ font-size: 32px; }
      .name{ font-size: 36px; }
      .wizard{ width: 150px; }
      .certificate{ min-height: 380px; }
      .content-layer{ padding-bottom: 110px; }
    }

    @media (max-width: 560px){
      .top h1{ font-size: 28px; }
      .title{ font-size: 26px; }
      .name{ font-size: 30px; }
      .wizard{ width: 120px; }
      .content-layer{ padding-bottom: 95px; }
    }
  </style>
</head>

<body>
  <div class="top">
    <h1>Join MagicBlock Community</h1>

    <div class="controls">
      <input id="userName" type="text" placeholder="Your name" />
      <select id="roleSelect">
        <option>@Wizard</option>
        <option>@Art Magician</option>
        <option>@Gaming Magician</option>
        <option>@Apprentice</option>
        <option>@Sorcerer</option>
        <option>@Adept</option>
        <option>@Inner Circle</option>
        <option>Mod</option>
        <option>Team</option>
      </select>
      <input id="sinceDate" type="date" />
      <button class="primary" id="generateBtn">Generate Certificate</button>
      <button id="downloadBtn">Download PDF</button>
    </div>
  </div>

  <div class="stage">
    <!-- THIS is what we export to PDF -->
    <div class="certificate" id="certificate">
      <!-- logo -->
      <div class="brand">
        <img src="./assets/logo.png" alt="Logo">
        <span>MagicBlock</span>
      </div>

      <!-- wizards -->
      <img class="wizard left"  src="./assets/wizard-left.png" alt="wizard left">
      <img class="wizard right" src="./assets/wizard.png"      alt="wizard right">

      <div class="content-layer">
        <div class="title">
          Certificate of <span class="mb">MagicBlock</span> Community Member
        </div>

        <div class="cert-body">
          <div class="small">This certifies that</div>
          <div class="name" id="certName">NAME</div>

          <div class="line">
            is an official <span style="color:var(--purple); font-weight:700;" id="certRole">ROLE</span>
            of the MagicBlock community
          </div>

          <div class="line">Member since: <span id="certSince">—</span></div>

          <div class="approved">Approved by MagicBlock Team</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const $ = (id) => document.getElementById(id);

    const userName   = $("userName");
    const roleSelect = $("roleSelect");
    const sinceDate  = $("sinceDate");

    const certName  = $("certName");
    const certRole  = $("certRole");
    const certSince = $("certSince");

    $("generateBtn").addEventListener("click", () => {
      const name = (userName.value || "NAME").trim();
      const role = roleSelect.value || "ROLE";

      certName.textContent = name;
      certRole.textContent = role;

      if (sinceDate.value) {
        // show YYYY-MM-DD (like your screenshot)
        certSince.textContent = sinceDate.value;
      } else {
        certSince.textContent = "—";
      }
    });

    $("downloadBtn").addEventListener("click", async () => {
      const node = $("certificate");

      // wait a moment for images to be ready
      await new Promise(r => setTimeout(r, 150));

      const canvas = await html2canvas(node, {
        scale: 2,
        useCORS: true,
        backgroundColor: null
      });

      const imgData = canvas.toDataURL("image/png");

      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF({
        orientation: "landscape",
        unit: "pt",
        format: "a4"
      });

      const pageW = pdf.internal.pageSize.getWidth();
      const pageH = pdf.internal.pageSize.getHeight();

      // fit image into page
      const ratio = Math.min(pageW / canvas.width, pageH / canvas.height);
      const w = canvas.width * ratio;
      const h = canvas.height * ratio;
      const x = (pageW - w) / 2;
      const y = (pageH - h) / 2;

      pdf.addImage(imgData, "PNG", x, y, w, h);
      pdf.save("magicblock-certificate.pdf");
    });
  </script>
</body>
</html>
